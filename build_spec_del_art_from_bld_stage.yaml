version: 0.1
component: build
timeoutInSeconds: 6000
runAs: root
shell: bash
env:
  variables:
    "testEnv" : "testVariable"
  exportedVariables:
    - UIM_DIGEST

steps:
  - type: Command
    name: "Make binary artifacts"
    command: |
      echo "Artifact 1 contents" > binaryArtifact.txt
      export UIM_DIGEST=$(sha256sum binaryArtifact.txt | cut -d " " -f 1)
  - type: Command
    name: "Make docker image"
    command: |
      docker build -t dockerImagetest:1.0 .
outputArtifacts:
  - name: BinaryArtifact
    type: BINARY
    location: binaryArtifact.txt
    registryId: ${REGISTRY_ID}
    path: ${ARTIFACT_PATH}
    version: ${ARTIFACT_VERSION}
  - name: DockerImage
    type: DOCKER_IMAGE
    location: dockerImagetest:1.0
    imageUri: ${IMAGE_URI}